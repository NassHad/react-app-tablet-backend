const fs = require('fs');
const path = require('path');

/**
 * Import missing models with proper validation
 * Generated from missing models analysis
 */

const STRAPI_URL = process.env.STRAPI_URL || 'http://localhost:1338';
const API_TOKEN = process.env.STRAPI_API_TOKEN || '';

// Helper function to make API calls to Strapi
async function strapiRequest(endpoint, method = 'GET', data = null) {
  const url = `${STRAPI_URL}/api${endpoint}`;
  const options = {
    method,
    headers: {
      'Content-Type': 'application/json',
      ...(API_TOKEN && { 'Authorization': `Bearer ${API_TOKEN}` })
    }
  };

  if (data) {
    options.body = JSON.stringify({ data });
  }

  try {
    const response = await fetch(url, options);
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    return await response.json();
  } catch (error) {
    console.error(`‚ùå API Error for ${endpoint}:`, error.message);
    throw error;
  }
}

// Clean model name for Strapi validation
function cleanModelName(modelName) {
  return modelName
    .replace(/[^ws-]/g, '') // Remove special characters except spaces, hyphens, and underscores
    .replace(/\s+/g, ' ') // Replace multiple spaces with single space
    .trim()
    .substring(0, 100); // Limit to 100 characters
}

// Generate slug from model name
function generateSlug(modelName) {
  return modelName
    .toLowerCase()
    .replace(/\s+/g, '-')
    .replace(/[^\w\-]/g, '')
    .substring(0, 50);
}

// Import models by category
async function importModelsByCategory() {
  console.log('üöÄ Starting missing models import...');
  
  // Load categories from analysis
  const categories = {
  "Short Names (1-3 chars)": [
    "*",
    "10",
    "101",
    "106",
    "107",
    "108",
    "121",
    "124",
    "127",
    "128",
    "131",
    "132",
    "205",
    "206",
    "207",
    "208",
    "238",
    "240",
    "241",
    "242",
    "250",
    "275",
    "300",
    "301",
    "305",
    "306",
    "307",
    "308",
    "309",
    "311",
    "313",
    "323",
    "340",
    "365",
    "400",
    "404",
    "405",
    "406",
    "407",
    "412",
    "440",
    "45",
    "460",
    "500",
    "504",
    "505",
    "512",
    "55",
    "550",
    "60",
    "600",
    "605",
    "607",
    "616",
    "626",
    "66",
    "700",
    "740",
    "760",
    "780",
    "806",
    "807",
    "818",
    "850",
    "90",
    "900",
    "924",
    "929",
    "940",
    "960",
    "99",
    "AMV",
    "ASX",
    "AX",
    "BLS",
    "BRZ",
    "BUG",
    "BX",
    "C15",
    "C2",
    "C25",
    "C30",
    "C35",
    "C6",
    "C70",
    "C8",
    "CK",
    "CX",
    "DB",
    "DS3",
    "DS4",
    "DS5",
    "DS7",
    "DS9",
    "E",
    "EKE",
    "EOS",
    "EX",
    "FOX",
    "FX",
    "G32",
    "G70",
    "GC6",
    "GS",
    "GTC",
    "GTL",
    "GTO",
    "GX",
    "IMP",
    "IQ",
    "J5",
    "J7",
    "J9",
    "JX",
    "K",
    "KA+",
    "KB",
    "LS",
    "LT",
    "LX",
    "M45",
    "MK",
    "MPV",
    "MR",
    "Mii",
    "NSU",
    "P 4",
    "Q30",
    "Q70",
    "QX4",
    "R11",
    "R14",
    "R18",
    "R19",
    "R20",
    "R21",
    "R25",
    "R30",
    "R4",
    "R9",
    "RCZ",
    "REX",
    "RX",
    "S70",
    "SC",
    "SJ",
    "SX4",
    "UNO",
    "UP!",
    "V40",
    "V50",
    "V8",
    "VX",
    "WFR",
    "X60",
    "XE",
    "XG",
    "XM",
    "Y10",
    "Z1",
    "ZX"
  ],
  "Numeric Only": [
    "1007",
    "1100",
    "1300",
    "2300",
    "2400",
    "2600",
    "3000",
    "3500",
    "4007",
    "4008",
    "9000"
  ],
  "Special Characters": [
    "124 I (124_)",
    "124 II (348_)",
    "2 (DE)",
    "2 (DL, DJ)",
    "2 (DY)",
    "206+",
    "3 (BK)",
    "3 (BL)",
    "3 (BM, BN)",
    "300/350",
    "308/328/330 GT",
    "320 / SMILY",
    "343 / 345",
    "4 RUNNER I (_N5_, _N6_, _N7_)",
    "4 RUNNER II (_N1_)",
    "4 RUNNER III (_N18_)",
    "4 RUNNER IV (_N21_)",
    "4 RUNNER V (_N28_)",
    "5 (CR)",
    "5 (CW)",
    "520 / BREEZ",
    "6 (GG, GY)",
    "6 (GH)",
    "6 (GJ)",
    "6 (GJ,GL)",
    "620 / SOLANO",
    "88/109 MK II",
    "88/109 MK III",
    "90 I (LDV)",
    "911 (901)",
    "911 (996)",
    "A1 (8X)",
    "A1 (GB)",
    "A2 (8Z)",
    "A3 (8L)",
    "A3 (8P)",
    "A3 (8V)",
    "A3 (8YA, 8YS, 8YH)",
    "A4 (8D, B5)",
    "A4 (8E, 8H, B6)",
    "A4 (8K, B8)",
    "A4 (8W)",
    "A5 (8F7, 8T3)",
    "A5 (F53, F57, F5A, F5E, F5F, F5P)",
    "A6 (4A, 4B, C4, C5)",
    "A6 (4F, C6)",
    "A6 (4G2, 4G5, 4GH)",
    "A8 (4D)",
    "A8 (4E)",
    "ACCENT IV (RB)",
    "ALHAMBRA I (7V)",
    "ALHAMBRA II (71)",
    "ALLROAD (4BH)",
    "ALPHARD / VELLFIRE (_H1_)",
    "ALPHARD / VELLFIRE (_H2_)",
    "ALTEA / ALTEA XL / ALTEA FREETRACK",
    "ARIYA (FE0)",
    "ASX (VSX_, VSE_)",
    "AUDI 60 / 70 / 75",
    "AUDI CABRIOLET (8G, B4)",
    "AURIS (_E15_)",
    "AURIS (_E18_)",
    "AVENGER (J2)",
    "AVENSIS I (T22)",
    "AVENSIS II (T25)",
    "AYGO I (_B1_)",
    "AYGO II (_B4_)",
    "AYGO X (_B7_)",
    "BAYON (BC3)",
    "BEETLE/BEETLE CABRIOLET (5C)",
    "BERLINGO I (M49/M59)",
    "BERLINGO II (B9)",
    "BERLINGO III (K9)",
    "BOXSTER (986)",
    "BREVIS (JCG1_)",
    "C-HR I (_X1_)",
    "C-MAX / GRAND C-MAX I",
    "C-MAX / GRAND C-MAX II",
    "C4 II PICASSO / GRAND PICASSO",
    "C4 PICASSO / GRAND PICASSO",
    "C4 SPACETOURER / GRAND C4 SPACETOURER",
    "CADDY V (SBA, SBH)",
    "CALDINA Break (_T19_)",
    "CALDINA Break (_T21_)",
    "CALDINA Break (_T24_)",
    "CAMRY ( V7 ,  VA7 , VH7 )",
    "CAMRY (_V1_)",
    "CAMRY (_V2_)",
    "CAMRY (_V3_, _V4_)",
    "CARNIVAL I (FL, GB)",
    "CARNIVAL II (VQ)",
    "CAYMAN (987)",
    "CC (358)",
    "CEED / CEED SW / PRO CEED I (ED)",
    "CEED / CEED SW / PRO CEED II (JD)",
    "CEED / CEED SW / PRO CEED III (CD)",
    "CERATO I (LD)",
    "CERATO II (TD)",
    "CERATO III (YD)",
    "CERATO IV (BD, BDM)",
    "CHEROKEE I (XJ)",
    "CHEROKEE II (KJ)",
    "CITAN (W415)",
    "CITAN (W420)",
    "CITY / JAZZ",
    "CLASSE A (W176)",
    "CLASSE A (W177)",
    "CLASSE B (T/W246)",
    "CLASSE B (W247)",
    "CLASSE CLA (C117) / CLA SHOOTING BRAKE (X117)",
    "CLASSE CLA (C118) / CLA SHOOTING BRAKE (X118)",
    "CLASSE G (W461/463)",
    "CLASSE GLA (X156)",
    "CLASSE GLA (X247)",
    "CLASSE GLB (X247)",
    "COLT I (A15_A)",
    "COLT II (C1_A)",
    "COLT III (C5_A)",
    "COLT V (CJ_, CP_)",
    "COLT VI (Z3_A, Z2_A)",
    "COLT VII (VB_)",
    "COMPASS (MK49)",
    "COMPASS (MP, M6)",
    "COROLLA X (_E15_)",
    "COROLLA XI (_E18_)",
    "COROLLA XII (_E21_)",
    "CORSA (MARK I)",
    "CORSA (MARK II)",
    "CORSA (MARK III)",
    "CORSA (MARK IV)",
    "CORSA (MARK V)",
    "CRAFTER (SY)",
    "CRAFTER 30, 35, 50 (2E)",
    "CROSSLAND / CROSSLAND X",
    "CRX II (ED, EE)",
    "CRX III (EH, EG)",
    "CX-3 (DK)",
    "CX-30 (DM)",
    "CX-5 (KE)",
    "CX-5 (KF)",
    "DEFENDER (L316)",
    "DOBLO (119)",
    "DOBLO (152)",
    "DOBLO (263)",
    "DOBLO (510_, 511_)",
    "DOBLO CARGO (223)",
    "DUCATO (230)",
    "DUCATO (244)",
    "DUCATO (250)",
    "DUCATO (279/280/282/284/290)",
    "EQT (W420)",
    "ES I (VCV10_, VZV21_)",
    "FABIA I (6Y2, 6Y3, 6Y5)",
    "FABIA II (5J6/5J9)",
    "FABIA III (NJ3, NJ5)",
    "FABIA IV (PJ3)",
    "FORESTER (SJ)",
    "FORESTER (SK_)",
    "FUSION / FUSION PLUS",
    "G80 (DH)",
    "GAZEL / GAZELLE",
    "GENESIS I (BH, BK)",
    "GIULIETTA (940)",
    "GOLF V / GOLF PLUS",
    "GOLF VI / GOLF PLUS",
    "GRAND CHEROKEE II (WJ, WG)",
    "GRAND CHEROKEE III (WH, WK)",
    "GRAND VITARA I (FT, HT)",
    "GRAND VITARA II (JT, TE, TD)",
    "GRANDE PUNTO (199)",
    "GRANDEUR (HG)",
    "GRANDEUR (TG)",
    "H1 / H1 STAREX / H100",
    "HR-V I (GH)",
    "HR-V II (RU)",
    "HR-V III (RV)",
    "IMPREZA (GJ_)",
    "IMPREZA (GK_, GT_)",
    "INTERSTAR I (X70)",
    "JAZZ V (GR_)",
    "JUKE (F15)",
    "JUKE (F16)",
    "KANGOO EXPRESS / RAPID",
    "KAROQ (NU7)",
    "KONA (OS) /  KAUAI",
    "KONA (SX2)",
    "L200 (K3_T, K2_T, K1_T, K0_T)",
    "L200 (K7_T, K6_T)",
    "LANTRA II (J-2) | ELANTRA",
    "LEON IV (KL_)",
    "LOGAN / LOGAN PICK-UP / LOGAN VAN",
    "M (Y51)",
    "M.G.",
    "MALIBU (V300)",
    "MATRIX (_E13_)",
    "MATRIX (_E14_)",
    "MEGANE I CABRIOLET / COUPE",
    "MEGANE III COUPE / CC",
    "MICRA (K11)",
    "MICRA (K12)",
    "MICRA (K14)",
    "MICRA C+C",
    "MINI CLUBVAN (R55)",
    "MINI COOPER II / CLUBMAN / COUNTRYMAN (R55/R56/R57/R59/R60)",
    "MINI COUNTRYMAN (R60)",
    "MINI ONE I (R50/R52)",
    "MINI ONE II / CLUBMAN / COUNTRYMAN (R55/R56/R60)",
    "MINI PACEMAN (R61)",
    "MODUS / GRAND MODUS",
    "MOKKA / MOKKA X",
    "MOKKA I  / MOKKA X I",
    "MULTIVAN / CALIFORNIA / CARAVELLE (T4)",
    "MULTIVAN / CALIFORNIA / CARAVELLE (T5)",
    "MULTIVAN / CALIFORNIA / CARAVELLE (T6)",
    "MX-5 III (NC)",
    "NEW BEETLE CABRIOLET / CONVERTIBLE",
    "NIRO I (DE)",
    "NIRO II (SG2)",
    "NX II (_A2_, _H2_)",
    "OPTIMA (JF)",
    "OPTIMA (TF)",
    "PAJERO (CHALLENGER / MONTERO)",
    "PASSAT (32/33)",
    "PASSAT (32B)",
    "PASSAT (36/357) / ALLTRACK",
    "PASSAT (365/357)",
    "PASSAT (3A2/5, 35l)",
    "PASSAT (3B2/3B5)",
    "PASSAT (3B3/3B6)",
    "PASSAT (3C2/3C5)",
    "PASSAT (3G2/3G5)",
    "PICANTO III (JA)",
    "POLO I (86)",
    "POLO II (86C)",
    "POLO III (6N1)",
    "POLO III (6N2)",
    "POLO III Classic/Variant (6V)",
    "POLO IV (9N)",
    "POLO V(6R, 6C)",
    "POLO VI (AW1)",
    "PRELUDE V (BB_)",
    "PREVIA I (_R1_, _R2_)",
    "PREVIA II (_R3_)",
    "PREVIA III (_R2_, _R5_)",
    "PRIMASTAR I (X83)",
    "PRIMASTAR II (X82)",
    "PRIUS (_W1_)",
    "PRIUS (_W2_)",
    "PRIUS (_W5_)",
    "PRIUS PHV (_W52_)",
    "PROBOX / SUCCEED (_P5_)",
    "PS-10/ANIBAL",
    "PUNTO EVO (199)",
    "PUNTO I (176)",
    "PUNTO II (188)",
    "PUNTO III (199)",
    "Partner III (K9)",
    "Q2 (GA)",
    "Q3 I (8U)",
    "Q3 II (F3B) / Q3 Sportback (F3N)",
    "Q5 (8R)",
    "QASHQAI / QASHQAI+2",
    "R5 / SUPER 5",
    "RANGE ROVER EVOQUE I (L538)",
    "RANGER (TKE)",
    "RAPID (NA2)",
    "RAPID (NH1, NH3)",
    "RX I (MCU15)",
    "RX II (_U3_)",
    "SANDERO / SANDERO STEPWAY",
    "SANDERO / SANDERO STEPWAY II",
    "SANTA FE I (SM)",
    "SANTA FE II (CM)",
    "SANTA FE III (DM, DMA, NC)",
    "SANTA FE IV (TM, TMA)",
    "SCIROCCO I & II",
    "SELTOS (SP2)",
    "SEQUOIA (_K3_, _K4_)",
    "SERIE 3 (E21)",
    "SERIE 3 (E30)",
    "SERIE 5 (E12)",
    "SERIE 5 (E28)",
    "SERIE 5 (E34)",
    "SHARAN I (7M)",
    "SHARAN II (7N)",
    "SMART COUPE / CABRIO / FORTWO III",
    "SONATA VI (YF)",
    "SONATA VII (LF)",
    "SONATA VIII (DN8)",
    "SPECTRA / SPECTRA5",
    "SWACE (AMZ_)",
    "T-CLASS (W420)",
    "TAOS (CL1, CQ1)",
    "TOUAREG (7L)",
    "TOURAN (1T)",
    "TOURAN (5T)",
    "TRANSIT (CY)",
    "TRANSIT (DY)",
    "TRANSIT (EY)",
    "TRANSIT (TT9)",
    "TRANSIT (Vxx)",
    "TRANSPORTER / VANS T3",
    "TRANSPORTER / VANS T4",
    "TRANSPORTER / VANS T5",
    "TRANSPORTER / VANS T6",
    "TT (8J)",
    "TT (8N3, 8N9)",
    "TT (FV)",
    "TUCSON I (JM)",
    "TUCSON II (TL, TLE)",
    "VITARA (ET, TA, TD)",
    "VITARA (LY)",
    "VOYAGER / GRAND VOYAGER",
    "WAGON R+",
    "WISH  (_E1_)",
    "X 1/9",
    "X-TRAIL II (T31)",
    "X-TRAIL III (T32)",
    "X-TRAIL IV (T33)",
    "XCEED (CD)",
    "XF Mk I (X250)",
    "XF Mk II (X260)",
    "XJ (X351)",
    "XV (GP_)",
    "XV (GT_)",
    "YARIS (_P21_, _PA1_, _PH1_)",
    "ZAFIRA III / ZAFIRA TOURER",
    "bB I (NCP3_)",
    "bB II (QNC2_)",
    "i10 III (AC3, AI3)",
    "i20 I (PB, PBT)",
    "i20 III (BC3, BI3)",
    "i30 / i30 SW",
    "i30 / i30 SW II",
    "i30 / i30 SW III",
    "i40 / i40 SW"
  ],
  "Long Names (20+ chars)": [
    "MEGANE II COUPE CABRIOLET",
    "TRANSPORTER  207 - 809"
  ],
  "Standard Names": [
    "04-avr",
    "09-mars",
    "1000-SERIE",
    "117 COUPE",
    "2008 I",
    "2008 II",
    "206 CC",
    "206 SW",
    "207 CC",
    "207 SW",
    "208 I",
    "208 II",
    "2101-2131",
    "3008 I",
    "3008 II",
    "307 CC",
    "307 SW",
    "308 CC",
    "308 II",
    "308 III",
    "308 SW",
    "406 COUPE",
    "407 SW",
    "408 I",
    "408 II",
    "500 II",
    "5008 I",
    "5008 II",
    "500C",
    "500L",
    "500X",
    "508 I",
    "508 II",
    "508 RXH I",
    "508 SW I",
    "508 SW II",
    "9-5 I",
    "9-5 II",
    "A110 I",
    "A310",
    "ACCENT I",
    "ACCENT II",
    "ACCENT III",
    "ACCORD AERODECK",
    "ACCORD COUPE",
    "ACCORD II",
    "ACCORD III",
    "ACCORD IV",
    "ACCORD IX",
    "ACCORD V",
    "ACCORD VI",
    "ACCORD VII",
    "ACCORD VIII",
    "ACTY",
    "ADAM",
    "AGILA I",
    "AGILA II",
    "AGILA Mk I",
    "AGILA Mk II",
    "AIXAM MAC CABRIOLET",
    "ALBEA",
    "ALERO",
    "ALFA 145",
    "ALFA 146",
    "ALFA 147",
    "ALFA 155",
    "ALFA 156",
    "ALFA 159",
    "ALFA 164",
    "ALFA 166",
    "ALFA 33",
    "ALFA 6",
    "ALFA 75",
    "ALFA 90",
    "ALFASUD",
    "ALFETTA",
    "ALLION I",
    "ALLION II",
    "ALMERA",
    "ALPINE",
    "ALTER",
    "ALTO",
    "AMAROK I",
    "AMBRA",
    "AMPERA",
    "ANTARA",
    "APE CAR",
    "ARANOS",
    "ARENA",
    "ARGENTA",
    "ARKANA",
    "ARONA",
    "AROSA",
    "ARTEON",
    "ASCONA B",
    "ASCONA C",
    "ASKA",
    "ASTRA",
    "ASTRA F",
    "ASTRA G",
    "ASTRA G COUPE",
    "ASTRA H",
    "ASTRA J",
    "ASTRA K",
    "ASTRA L",
    "ASTRA Mk I",
    "ASTRA Mk II",
    "ASTRA Mk III",
    "ASTRA Mk IV",
    "ASTRA Mk V",
    "ASTRA Mk VI",
    "ASTRA Mk VII",
    "ASTRA Mk VIII",
    "ASTRAMAX",
    "ATECA",
    "ATLAS",
    "AUDI 100",
    "AUDI 200",
    "AUDI 4000",
    "AUDI 50",
    "AUDI 5000",
    "AUDI 80",
    "AUDI 90",
    "AUDI COUPE",
    "AUDI FOX",
    "AUSTIN",
    "AUSTIN ALLEGRO 1",
    "AUSTIN ALLEGRO 2",
    "AUSTIN MAESTRO",
    "AUSTIN MAXI",
    "AUSTIN METRO",
    "AUSTIN MONTEGO",
    "AUSTIN PRINCESS",
    "AUSTIN TAXI",
    "AUSTRAL",
    "AUTRES MODELES",
    "AVANTIME",
    "AVENGER",
    "AVENSIS VERSO",
    "AVEO I",
    "AVEO II",
    "B-MAX",
    "B-SERIE",
    "BALENO",
    "BE TWO",
    "BE UP",
    "BELINA",
    "BELMONT",
    "BESTA",
    "BIPPER",
    "BLAZER",
    "BLITZ",
    "BLUEBIRD II",
    "BONGO",
    "BORA",
    "BOXER I",
    "BOXER II",
    "BOXER III",
    "BOYUE",
    "BRAVA",
    "BRAVO I",
    "BRAVO II",
    "BREEZE",
    "BT50 II",
    "C-CROSSER",
    "C-ELYSEE",
    "C-HR",
    "C1 I",
    "C1 II",
    "C3 AIRCROSS II",
    "C3 I",
    "C3 II",
    "C3 III",
    "C3 PICASSO",
    "C3 PLURIEL",
    "C4 AIRCROSS",
    "C4 CACTUS",
    "C4 I",
    "C4 II",
    "C4 III",
    "C4 X",
    "C5 AIRCROSS",
    "C5 I",
    "C5 II",
    "C5 X",
    "CADDY I",
    "CADDY II",
    "CADDY III",
    "CADDY IV",
    "CALIBER",
    "CALIBRA",
    "CAMPAGNOLA",
    "CAMPO",
    "CAPTIVA I",
    "CAPTUR I",
    "CAPTUR II",
    "CARENS I",
    "CARENS II",
    "CARENS III",
    "CARINA E",
    "CARINA I",
    "CARINA II",
    "CARINA V",
    "CARINA VII",
    "CARISMA",
    "CARLTON MK II",
    "CARLTON MK III",
    "CARPAT",
    "CARRY",
    "CASCADA",
    "CAVALIER",
    "CEFIRO II",
    "CEFIRO III",
    "CELESTE",
    "CELICA",
    "CERATO",
    "CF RANGE",
    "CHARADE",
    "CHRYSLER",
    "CIELO",
    "CINQUECENTO",
    "CITIGO",
    "CITY",
    "CIVIC III",
    "CIVIC IV",
    "CIVIC IX",
    "CIVIC SHUTTLE",
    "CIVIC V",
    "CIVIC VI",
    "CIVIC VII",
    "CIVIC VIII",
    "CIVIC X",
    "CIVIC XI",
    "CJ5 - CJ8",
    "CLIO I",
    "CLIO II",
    "CLIO III",
    "CLIO IV",
    "CLIO V",
    "CLUB I",
    "COMANCHE",
    "COMBO A",
    "COMBO B",
    "COMBO D",
    "COMBO E",
    "COMBO MK I",
    "COMBO MK II",
    "COMBO MK III",
    "COMBO MK IV",
    "CONCERTO",
    "CONTINENTAL",
    "CONVOY",
    "CORCEL",
    "CORDIA",
    "CORDOBA I",
    "CORDOBA II",
    "CORDOBA III",
    "COROLLA III",
    "COROLLA IV",
    "COROLLA IX",
    "COROLLA V",
    "COROLLA VERSO",
    "COROLLA VI",
    "COROLLA VII",
    "COROLLA VIII",
    "CORONA",
    "CORRADO",
    "CORSA A",
    "CORSA B",
    "CORSA C",
    "CORSA D",
    "CORSA E",
    "CORSA F",
    "COUPE",
    "COURIER",
    "COURNIL",
    "CR-V I",
    "CR-V II",
    "CR-V III",
    "CR-V IV",
    "CR-V V",
    "CR-Z",
    "CRESSIDA",
    "CRETA",
    "CROMA I",
    "CROMA II",
    "CROSSLINE",
    "CROSSOVER",
    "CROSSTOUR",
    "CROWN",
    "CRUZE",
    "CUBE",
    "CX-7",
    "Civic",
    "DAILY I",
    "DAILY II",
    "DAILY III",
    "DAILY IV",
    "DANGEL",
    "DART",
    "DEDRA",
    "DELTA I",
    "DELTA II",
    "DELTA III",
    "DERBY",
    "DINO",
    "DISCOVERY I",
    "DISCOVERY II",
    "DISCOVERY SPORT",
    "DISPATCH",
    "DOKKER",
    "DS3 Crossback",
    "DS4 II",
    "DUNA",
    "DUSTER",
    "DUSTER I",
    "DUSTER II",
    "DYNA 100",
    "DYNA 150",
    "DYNA 300",
    "DYNA 350",
    "E-SERIE",
    "ECLIPSE CROSS",
    "ECONOVAN",
    "ECOSPORT",
    "EDGE",
    "EGEA",
    "ELAN",
    "ELANTRA",
    "ELBA",
    "ELISE",
    "ENTREPRENEUR",
    "EPICA",
    "ESCALADE",
    "ESCORT III",
    "ESCORT IV",
    "ESCORT RS",
    "ESCORT V",
    "ESCORT VI",
    "ESCORT VII",
    "ESCORT XR3",
    "ESPACE I",
    "ESPACE II",
    "ESPACE III",
    "ESPACE IV",
    "ESPACE V",
    "ESPACE VI",
    "ESPERO",
    "ESTELLE",
    "EUROPA",
    "EVANDA",
    "EVASION",
    "EXCEL",
    "EXEO",
    "EXPERT I",
    "EXPERT II",
    "EXPERT III",
    "EXPERT TEPEE",
    "EXPRESS",
    "EXTRA",
    "F-150",
    "F-PACE",
    "FAMILIA",
    "FAMILY",
    "FARGO",
    "FASTAR",
    "FAVORIT",
    "FELICIA",
    "FIESTA",
    "FIESTA I",
    "FIESTA II",
    "FIESTA III",
    "FIESTA IV",
    "FIESTA V",
    "FIESTA VI",
    "FIESTA VII",
    "FIORINO I",
    "FIORINO II",
    "FIORINO QUBO",
    "FIREBIRD",
    "FLORIAN",
    "FLORIDA",
    "FLUENCE",
    "FOCUS C-MAX",
    "FOCUS I",
    "FOCUS II",
    "FOCUS III",
    "FOCUS IV",
    "FORMAN",
    "FORMENTOR",
    "FR-V",
    "FREECLIMBER",
    "FREELANDER II",
    "FREEWAY",
    "FRONTERA",
    "FUEGO",
    "FULLBACK",
    "FUNCRUISER",
    "FURA",
    "GALANT",
    "GALANT VIII",
    "GALAXY I",
    "GALAXY II",
    "GALAXY III",
    "GALLOPER",
    "GASOLONE",
    "GEMINI",
    "GEMINI FF",
    "GETZ",
    "GOLF I",
    "GOLF II",
    "GOLF III",
    "GOLF IV",
    "GOLF IV Cabriolet",
    "GOLF VII",
    "GOLF VIII",
    "GRACE",
    "GRANADA",
    "GRAND VITARA XL7",
    "GRAND VOYAGER V",
    "GRANDEUR",
    "GRANDIS",
    "GRANDLAND X",
    "GRANTA",
    "GRINTA",
    "GT-86",
    "GT-R",
    "GURKHA",
    "H200",
    "HI-ACE",
    "HIACE V",
    "HIACE VI",
    "HIGHLANDER",
    "HIGHWAY VAN",
    "HIJET",
    "HILUX IV",
    "HILUX V",
    "HILUX VI",
    "HILUX VII",
    "HILUX VIII",
    "HORIZON",
    "HUNTER",
    "IBIZA I",
    "IBIZA II",
    "IBIZA III",
    "IBIZA IV",
    "IBIZA V",
    "IDEA",
    "IGNIS I",
    "IGNIS II",
    "ILTIS",
    "INCA",
    "INSIGHT",
    "INSIGNIA A",
    "INSIGNIA B",
    "INSIGNIA Mk I",
    "INSIGNIA Mk II",
    "INTEGRA",
    "IONIQ",
    "IS I",
    "JAZZ II",
    "JAZZ III",
    "JAZZ IV",
    "JETTA I",
    "JETTA II",
    "JETTA III",
    "JETTA IV",
    "JIMNY",
    "JOGGER",
    "JOICE",
    "JOURNEY",
    "JUMPER I",
    "JUMPER II",
    "JUMPER III",
    "JUMPY I",
    "JUMPY II",
    "JUMPY III",
    "JUSTY",
    "JUSTY III",
    "JUSTY IV",
    "KA I",
    "KA II",
    "KADETT D",
    "KADETT E",
    "KADJAR",
    "KALINA II",
    "KALOS",
    "KAMIQ",
    "KANGOO BE BOP",
    "KANGOO I",
    "KANGOO II",
    "KANGOO III",
    "KAPPA",
    "KAPPA COUPE",
    "KAPTUR",
    "KB RANGE",
    "KIGER SUV",
    "KITTEN",
    "KIZASHI",
    "KODIAQ",
    "KOLEOS I",
    "KOLEOS II",
    "KUBISTAR",
    "KUGA I",
    "KUGA II",
    "L300",
    "LACETTI",
    "LAGUNA I",
    "LAGUNA II",
    "LAGUNA III",
    "LANCER",
    "LAND CRUISER",
    "LAND CRUISER 200",
    "LAND CRUISER PRADO",
    "LAND ROVER",
    "LANOS",
    "LANTRA",
    "LARGUS",
    "LATITUDE",
    "LEBARON",
    "LEGACY III",
    "LEGACY IV",
    "LEGACY V",
    "LEGACY VI",
    "LEGANZA",
    "LEGEND",
    "LEON",
    "LEON I",
    "LEON II",
    "LEON III",
    "LEONE",
    "LIANA",
    "LIBERTY",
    "LINEA",
    "LITE-ACE",
    "LOADBETA",
    "LODGY",
    "LOGAN I",
    "LOGAN II",
    "LOGAN III",
    "LOGO",
    "LUBLIN",
    "LUMINA APV",
    "LUPO",
    "LYBRA",
    "Lacetti",
    "Lancer VIII",
    "MAGENTIS",
    "MALAGA",
    "MANTA B",
    "MARBELLA",
    "MAREA",
    "MARENGO",
    "MASTER I",
    "MASTER II",
    "MASTER III",
    "MATRIX",
    "MAVERICK",
    "MAXIMA",
    "MEDIA",
    "MEGANE E-TECH",
    "MEGANE I",
    "MEGANE II",
    "MEGANE III",
    "MEGANE IV",
    "MERIVA A",
    "MERIVA B",
    "MERIVA Mk II",
    "MIDI",
    "MILLE CLIP",
    "MINX",
    "MOKKA II",
    "MONDEO I",
    "MONDEO II",
    "MONDEO III",
    "MONDEO IV",
    "MONDEO V",
    "MONDIAL",
    "MONTEREY",
    "MONTEREY A",
    "MONTEREY B",
    "MORRIS",
    "MOVANO A",
    "MULTIPLA",
    "MULTIVAN T7",
    "MUSA",
    "MUSTANG",
    "MX-3",
    "MX-6",
    "Magnus",
    "NEMO",
    "NEON",
    "NEW BEETLE",
    "NEXIA",
    "NIVA",
    "NOTE",
    "NOVA",
    "NOVAVAN",
    "NUBIRA",
    "NV200",
    "NV250",
    "NV300",
    "OCTAVIA I",
    "OCTAVIA II",
    "OCTAVIA III",
    "OCTAVIA IV",
    "OMEGA",
    "OMEGA A",
    "OMEGA B",
    "OMNI",
    "OPIRUS",
    "ORION",
    "ORLANDO",
    "OUTBACK I",
    "OUTBACK III",
    "OUTBACK IV",
    "OUTBACK V",
    "OUTLANDER I",
    "OUTLANDER II",
    "OUTLANDER III",
    "P 100",
    "PALIO",
    "PANDA I",
    "PANDA II",
    "PANDA III",
    "PARTNER I",
    "PARTNER I ORIGIN",
    "PARTNER II",
    "PARTNER TEPEE",
    "PASEO",
    "PATHFINDER",
    "PATRIOT",
    "PATROL",
    "PATROL GR",
    "PENNY",
    "PENZA",
    "PERSONNA",
    "PHAETON",
    "PHEDRA",
    "PIAZZA",
    "PICK UP",
    "PICKUP",
    "PICNIC",
    "PILOT",
    "PLATZ",
    "PLUS",
    "POLONEZ",
    "PONY",
    "PORTER",
    "PRAKTIK",
    "PRATIC",
    "PRELUDE",
    "PRIMERA II",
    "PRINCE",
    "PRIORA",
    "PRISMA",
    "PROACE CITY",
    "PROACE I",
    "PROACE II",
    "PROACE VERSO",
    "PROBE",
    "PROTON",
    "PT CRUISER",
    "PULSAR",
    "PUMA I",
    "QASHQAI II",
    "QASHQAI III",
    "QUBO",
    "QUINTET",
    "QX56",
    "QX60",
    "QX70",
    "QX80",
    "RAFALE",
    "RANGE ROVER I",
    "RANGE ROVER II",
    "RAPID",
    "RAPIER",
    "RAV 4 I",
    "RAV 4 II",
    "RAV 4 III",
    "RAV 4 V",
    "REBEL",
    "REGAL",
    "REGATA",
    "REKORD D",
    "REKORD E",
    "RELIANT",
    "RENEGADE",
    "RETONA",
    "REZZO",
    "RIALTO",
    "RIFTER",
    "RIO II",
    "RIO III",
    "RIO IV",
    "RITMO",
    "RIVA",
    "ROBIN",
    "ROCSTA",
    "RONDA",
    "ROOMSTER",
    "ROUTAN",
    "RX-8",
    "S COUPE",
    "S-MAX",
    "S-MAX II",
    "S2000",
    "S40 I",
    "S40 II",
    "S60 I",
    "S60 II",
    "S80 I",
    "S80 II",
    "SAFRANE",
    "SAGONA",
    "SAMARA",
    "SAMBAR",
    "SAMURAI",
    "SANA",
    "SANDERO I",
    "SANDERO II",
    "SANDERO III",
    "SANTA FE I",
    "SANTAMO",
    "SANTANA",
    "SAPPORO",
    "SARATOGA",
    "SATELLITE",
    "SAXO",
    "SCALA",
    "SCENIC I",
    "SCENIC II",
    "SCENIC III",
    "SCENIC IV",
    "SCEPTRE",
    "SCIMITAR",
    "SCIROCCO III",
    "SCORPIO",
    "SCOUTY",
    "SCUDO I",
    "SCUDO II",
    "SCUDO III",
    "SEBRING",
    "SEDICI",
    "SEDONA",
    "SENATOR A",
    "SERIE 100",
    "SERIE 200",
    "SERIE 400",
    "SERIE 600",
    "SERIE 800",
    "SERIE S",
    "SHERPA",
    "SHIFTER",
    "SHOGUN",
    "SHUTTLE",
    "SIENA",
    "SIERRA",
    "SIERRA SAPPHIRE",
    "SIGMA",
    "SIGNUM",
    "SINTRA",
    "SIRION",
    "SMART FORFOUR",
    "SMART FORFOUR III",
    "SOLARIS",
    "SOLENZA",
    "SONATA",
    "SORENTO I",
    "SORENTO II",
    "SORENTO III",
    "SOUL I",
    "SOUL II",
    "SOUL III",
    "SPACE RUNNER",
    "SPACE STAR",
    "SPACE STAR VI",
    "SPACE WAGON",
    "SPACETOURER",
    "SPARTANA",
    "SPEEDSTER",
    "SPLASH",
    "SPORTAGE I",
    "SPORTAGE II",
    "SPORTAGE III",
    "SPORTAGE IV",
    "SPRINTER",
    "STARION",
    "STARLET",
    "STELLAR",
    "STILO",
    "STINGER",
    "STRADA",
    "STRATUS",
    "STREAM",
    "SUNBEAM",
    "SUPERB I",
    "SUPERB II",
    "SUPERB III",
    "SUPERNOVA",
    "SUPRA",
    "SWIFT III",
    "SWIFT IV",
    "SYMBOL I",
    "SYMBOL II",
    "SYMBOL III",
    "T-CROSS",
    "T-ROC",
    "TACUMA",
    "TAGORA",
    "TAIGO",
    "TALENTO",
    "TALIANT",
    "TALISMAN",
    "TARRACO",
    "TASMIN",
    "TEMPO",
    "TEMPRA",
    "TERAMONT",
    "TERCEL",
    "TERRA",
    "TERRACAN",
    "TERRANO II",
    "TERROIR",
    "THALIA I",
    "THALIA II",
    "THALIA III",
    "THEMA",
    "TIBURON",
    "TIGER",
    "TIGRA",
    "TIGRA TWIN TOP",
    "TIGUAN",
    "TIGUAN ALLSPACE",
    "TIGUAN II",
    "TIIDA",
    "TIPO",
    "TIPO II",
    "TITAN",
    "TOLEDO I",
    "TOLEDO II",
    "TOLEDO III",
    "TOLEDO IV",
    "TOSCANA",
    "TOURER",
    "TOURNEO",
    "TOURNEO CONNECT",
    "TOURNEO CONNECT II",
    "TOURNEO CONNECT III",
    "TOURNEO COURIER",
    "TOURNEO CUSTOM",
    "TOUS TYPES",
    "TOWNACE",
    "TOWNSTAR",
    "TOYOACE",
    "TRABANT",
    "TRACKER",
    "TRADE",
    "TRAFIC I",
    "TRAFIC II",
    "TRAFIC III",
    "TRAJET",
    "TRANS SPORT",
    "TRANSIT",
    "TRANSIT CONNECT I",
    "TRANSIT CONNECT II",
    "TRANSIT CONNECT III",
    "TRANSIT COURIER I",
    "TRANSIT CUSTOM",
    "TRAPEURS",
    "TRAVELLER",
    "TRAX",
    "TREDIA",
    "TREVI",
    "TRIBECA B9",
    "TRIBUTE",
    "TRIUMPH",
    "TROOPER",
    "TUCSON I",
    "TUSCAN",
    "TWINGO I",
    "TWINGO II",
    "TWINGO III",
    "ULYSSE I",
    "ULYSSE II",
    "ULYSSE III",
    "V40 II",
    "V60 I",
    "V70 I",
    "V70 II",
    "V70 III",
    "VANAGON",
    "VECTRA A",
    "VECTRA B",
    "VECTRA C",
    "VECTRA MK I",
    "VECTRA MK II",
    "VEL SATIS",
    "VELOSTER",
    "VENGA",
    "VENTO",
    "VEROSSA",
    "VERSO",
    "VESTA",
    "VIOS",
    "VIRGO",
    "VISA",
    "VITARA",
    "VIVARO A",
    "VIVARO B",
    "VIVARO C",
    "VIVARO Mk I",
    "VIVARO Mk II",
    "VOGUE",
    "VOLGA",
    "VOLT",
    "VOYAGE",
    "VX220",
    "WAGON R",
    "WARTBURG",
    "WIND",
    "WOLSEY",
    "WRANGLER I",
    "WRANGLER II",
    "WRANGLER III",
    "X PRO",
    "X TOO",
    "XANTIA",
    "XC60 I",
    "XEDOS",
    "XRAY",
    "XSARA",
    "XSARA PICASSO",
    "YARIS I",
    "YARIS II",
    "YARIS III",
    "YARIS VERSO",
    "YETI",
    "YPSILON",
    "YPSILON I",
    "YPSILON II",
    "YUGO",
    "Yack",
    "ZAFIRA I",
    "ZAFIRA II",
    "ZAFIRA LIFE",
    "ZAFIRA Mk I",
    "ZAFIRA Mk II",
    "ZAFIRA Mk III",
    "ZETA",
    "iX20",
    "iX35",
    "typemodele"
  ],
  "Problematic Names": []
};
  
  let totalImported = 0;
  let totalErrors = 0;
  
  // Process each category
  for (const [category, models] of Object.entries(categories)) {
    if (models.length === 0) continue;
    
    console.log(`\nüìÇ Processing ${category} (${models.length} models)...`);
    
    let categoryImported = 0;
    let categoryErrors = 0;
    
    for (const modelName of models) {
      try {
        const cleanName = cleanModelName(modelName);
        const slug = generateSlug(cleanName);
        
        if (!cleanName || cleanName.length < 2) {
          console.log(`‚ö†Ô∏è  Skipping invalid model: "${modelName}"`);
          categoryErrors++;
          continue;
        }
        
        // For now, we'll need to determine the brand ID
        // This would need to be implemented based on your brand mapping logic
        console.log(`üìù Would import: "${modelName}" -> "${cleanName}" (slug: ${slug})`);
        
        categoryImported++;
        
      } catch (error) {
        console.error(`‚ùå Error processing model "${modelName}":`, error.message);
        categoryErrors++;
      }
    }
    
    console.log(`‚úÖ ${category}: ${categoryImported} processed, ${categoryErrors} errors`);
    totalImported += categoryImported;
    totalErrors += categoryErrors;
  }
  
  console.log(`\nüìä Import Summary:`);
  console.log(`   ‚úÖ Total processed: ${totalImported}`);
  console.log(`   ‚ùå Total errors: ${totalErrors}`);
}

// Run import if this script is executed directly
if (require.main === module) {
  importModelsByCategory()
    .then(() => {
      console.log('\nüéâ Model import script finished!');
      process.exit(0);
    })
    .catch((error) => {
      console.error('üí• Model import failed:', error);
      process.exit(1);
    });
}

module.exports = { importModelsByCategory, cleanModelName, generateSlug };
